# Submissions

## `submission1_empty`

* Evaluation score: 0.0652882.
* Public leaderboard score: 0.0633200.

Predict an empty order for each user.

## `submission2_frequent_products_0.9`

* Evaluation score: 0.3311267.
* Public leaderboard score: 0.3327150.

Predict the most frequent reordered products.

## `submission3_previous_order_reordered`

* Evaluation score: 0.0.3267794.
* Public leaderboard score: 0.3276826.

Repeat the reordered products in the previous order.

## `submission4_mlp_v1_3_relu_0.5_0.1`

* Evaluation score: 0.3411528.
* Public leaderboard score: 0.3436402.

Multilayer perceptron with 3 hidden layers using ReLU activations and dropout of 0.5.

The problem is modelled as a binary classification problem at the product level.
The training sample is generated by considering a single sequence per user:
the reordered products in the last order are considered as positive examples,
and all the other previously ordered products as negative examples.

Predictions are generated only for previously purchased products and the
score threshold for positive or negative predictions is the same for all users
(optimized on the validation set).

* User features:
  * [Customer value](https://en.wikipedia.org/wiki/RFM_(customer_value)).
  * Day of the week (one-hot encoding).
  * [Time of the day](https://ianlondon.github.io/blog/encoding-cyclical-features-24hour-time/).
* Product features:
  * Aisle (one-hot encoding).
  * Product popularity: number of orders that include the product.
  * Product frequency: how often is the product reordered?
* User and product features:
  * User product preference: how many times has the user ordered the product?
  * User product recency: number of days since the user last ordered the product.
  * User product frequency: how often does the user reorder the product?

### Notes

* Add more features.
* Use of previous orders to generate the training samples, not just the last order for each user.
* Estimate a specific threshold for each user (or predict the number of reordered products directly).

## `mlp_v2_5_91_5_3_0.5_threshold_0.173`

* Evaluation score: 0.3575911.
* Public leaderboard score: 0.3617654.

Multilayer perceptron having as input:
* an embedding vector corresponding to the product to be evaluated,
* a binary vector indicating whether the user ordered the product or not over a number of
  days in the past leading to the day of the order.

### Notes

* Add user and product features.
* I tried to balance the classes using `class_weight` but it did't improve the results.
